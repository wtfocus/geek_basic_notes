[toc]

## 33 | 字符串匹配基础（中）：如何实现文本编辑器中的查找功能？

![img](imgs/4f5a919c1ad1d3b83c98cf94215bba16.jpg)

1.  开篇题
    -   比 BF / RK 算法更加高效的字符串匹配算法 -- BM(Boyer-Moore) 算法

### 核心思想

1.  当模式串和主串的匹配过程中，当遇到不匹配的字符时。
    1.  BF/RK 算法的做法是，模式串往后**滑动一位**。
        -   ![img](imgs/4316dd98eac500a01a0fd632bb5e77f9.jpg)
    2.  当主串中的 c，在模式串中是不存在的。所以，模式串向后滑动的时候，只要 c 与模式串**没有重合**，肯定无法匹配。所以，我们可以一次性把模式串往后**滑动几位**，把模式串移动到 c 的后面。
        -   ![img](imgs/cf362f9e59c01aaf40a34d2f10e1ef15.jpg)
2.  我们今天要讲的 BM 算法，本质上其实就是借助这种规律，在模式串与主串匹配的过程中，当模式串和主串某个字符不匹配的时候，能够跳过一些肯定不会匹配的情况，将模式串往后**多滑动几位**。

### 原理分析

1.  BM 算法包含两部分，分别是**坏字符规则**和**好后缀规则**。

#### 坏字符规则

1.  从模式串的**末尾往前倒着匹配**，当发现某个字符没法匹配的时候，我们把这个没有匹配的字符叫作**坏字符（主串中的字符）**。
    -   ![img](imgs/540809418354024206d9989cb6cdd89e.jpg)
2.  我们拿坏字符 c 在**模式串**中查找，发现模式串中并**不存在**这个字符。这时，我们可以将模式串直接往后滑动到 c 后面的位置，再从模式串的**末尾**字符开始比较。
    -   ![img](imgs/4e36c4d48d1b6c3b499fb021f03c7f64.jpg)
3.  第二次匹配时，当发生不匹配的时候，我们把**坏字符**对应的**模式串中**的字符下标记作 si。如果坏字符在模式串中存在，我们把这个坏字符在模式串中的下标记作 xi。如果不存在，我们把 xi 记作 -1。那模式串往后移动的位数就等于 **si-xi**。
    -   ![img](imgs/8f520fb9d9cec0f6ea641d4181eb432e.jpg)
    -   那我们选择 xi 的时候，选择**最靠后**的那个。

### 好后缀规则

1.  好后缀定义
    -   ![img](imgs/d78990dbcb794d1aa2cf4a3c646ae58a.jpg)
2.  好后缀，记作{u}。我们拿它在模式串中查找，如果**找到了**另一个跟{u}相匹配的子串{u\*}，那我们就将模式串滑动到子串{u*}与主串中{u}对齐的位置。
    -   ![img](imgs/b9785be3e91e34bbc23961f67c234b63.jpg)
3.  如果没找到，这时，我们就要考察**好后缀的后缀子串，是否存在跟模式串的前缀子串匹配的。**
    -   ![img](imgs/6caa0f61387fd2b3109fe03d803192f9.jpg)

### 代码实现

1.  未完待续...